\section{Runge-Kutta time-integration}

After the former chapters treated numerical method to calculate the (spatial) derivative of a given function, we now want to devote to the temporal integration in order to deal with the initial value problem (IVP) of an ordinary differential equation (ODE). I.e. we want to find the function $u(t)$, and all we know is its derivative
\begin{equation}
  \frac{\mathrm{d} u}{\mathrm{d} t} = F(u)
  \label{eq:drvtv}
\end{equation}
and the initial value $u(t = 0) = u_0$.
We assume $F(u)$ to be continous, especially Lipschitz continous, to make sure that there exists exactly one solution for the IVP.
% QUELLE : 2011_Book_Numerik-Algorithmen
\subsection{General Principle of Numerical Integration Methods}
Simliarly to the spatial differentian methods, the first step is to discretize the respective intervall. Generally, this discretization does not have to be equidistant, so we define
\begin{equation}
  \Delta t_i = t_{i+1} - t_i >0
\end{equation}
to be the local step sizes for $i = 0,..., n-1$.
Now we search for approximate values $U_i = U(t_i) \approx u(t_i) = u_i$.
By integrating both sides of \ref{eq:drvtv} over $t$ we find
\begin{equation}
  u(t_{i+1}) = u(t_i) + \int_{t_i}^{t_{i+1}} F(t,u(t)) \mathrm{d}t \qquad \text{for } i = 0,...,n-1
\end{equation}
Different methods are distinguished, depending on how the integral is solved. \emph{One-step methods} take into acocunt only the previous value, hence calculating $U_{i+1}$ from $U_i$. \emph{Multi-step methods} use more than one previous values and \emph{extrapolation algorithms} use the Richardson approximation to improve results from integration by trapezoidal or rectangular integration methods.
In the following we want to focus on the one-step methods, especially the Runge-Kutta methods, as this is the most common one in usage.

One very simple approach is the Euler-Cauchy method, where $U_{i+1}$ is approximated just as a linear continuitation from $U_i$. As this method failes even for very simple functions (e.g. think of a quadratic function which very fast will diverge from that tangential approximation), this method was improved by taking into account the function's further derivatives (tangents).
% HIER EVTL NEN BILD EINFÃœGEN

\subsection{Runge-Kutta Methods}

A Runge-Kutta method (RK method) in general can be written as
\begin{align}
U_{i+1} &= U_i + \Delta t_i \sum_{j=1}^s b_j k_j(t_i, U_i, \Delta t_i) \\
&\text{where} \quad k_j(t, U, \Delta t) = F(t+c_j\Delta t, U+ \Delta t\sum_{m=0}^{j-1} a_{jm} k_m(t,U,\Delta t))
\end{align}
with the set of characteristic coefficients $(a_{jm}, b_j, c_j)$ for $j = 1,...,s$ where $s$ denotes the so-called \emph{stage} of the algorithm.
It estimates a function's next point by evaluating the weighted average of various derivates at pieces of the next time step.
The most common variant of doing so is using half time steps and therefor getting four helping tangents, whichs average value then acts as the linear continuitation's increase. Hence, this version is referred to as the \emph{Fourth Order RK method, RK4} or simply \emph{Classical RK method} and will be treated in more detail below.

\paragraph{The Butcher Table}
% Butcher table
The characterisistic coefficients $c_j, b_j$ and $a_{jm}$ are ususally written in the \emph{Butcher table}, i.e.
\begin{equation}
  \begin{pmatrix}
    c_j & a_{jm} \\
    & b_j^T
  \end{pmatrix}
  =
  \begin{pmatrix}
    0 &&&&\\
    c_2 & a_{21} & a_{22} & \dots & \\
    c_3 & a_{31} & a_{32} && \\
    \vdots & \vdots & &\ddots &\\
    c_s & a_{s1} & a_{s2} & \dots & a_{s, s-1} \\
    & b_1 & b_2 & \dots & b_{s-1} & b_s
  \end{pmatrix}
\end{equation}





\paragraph{Explicit and Implicit RK methods}
A RK method can be either explicit or implicit, depending on how many coefficients $a_{jm}$ are taken into account for the calculation of $k_i$. With respect to the Butcher table, this means that explicit methods only have the lower diagonal elements of the the $a_{jm}$ nonzero, hence is a triangular matrix, whereas for implicit method all matrix elements are eventually nonzero. This yields in a higher stability for the implicit methods, as more terms are used. Their application is required for some partial differential equations, especially for stiff problems. % , where a very high stability is reuired, one may consider using an implicit RK method
% For a explicit RK scheme the matrix containing the coeffients $a_jm$ is of lower triangular form, for an implicit scheme the matrix $a_{jm}$ has nonzero elements everywhere.



\paragraph{Estimated Error}
From the stage number $s$ one can estimate the magnitude of error, e.g. for $s \leq 4$ the local error is of order $s +1$.


....
(Derivation of how RK4 has error of order t5)
.....







\paragraph{Example Code for the 4-stage RK Method}
